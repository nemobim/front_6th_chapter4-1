import{b as e,c as t}from"./HttpResponse-BVBNg0V1.js";import{b as n}from"./items-AvamnXs5.js";const r=async()=>await new Promise(e=>setTimeout(e,200));function i(){let e={};return n.forEach(t=>{let n=t.category1,r=t.category2;e[n]||(e[n]={}),r&&!e[n][r]&&(e[n][r]={})}),e}function a(e,t){let n=[...e];if(t.search){let e=t.search.toLowerCase();n=n.filter(t=>t.title.toLowerCase().includes(e)||t.brand.toLowerCase().includes(e))}if(t.category1&&(n=n.filter(e=>e.category1===t.category1)),t.category2&&(n=n.filter(e=>e.category2===t.category2)),t.sort)switch(t.sort){case`price_asc`:n.sort((e,t)=>parseInt(e.lprice)-parseInt(t.lprice));break;case`price_desc`:n.sort((e,t)=>parseInt(t.lprice)-parseInt(e.lprice));break;case`name_asc`:n.sort((e,t)=>e.title.localeCompare(t.title,`ko`));break;case`name_desc`:n.sort((e,t)=>t.title.localeCompare(e.title,`ko`));break;default:n.sort((e,t)=>parseInt(e.lprice)-parseInt(t.lprice))}return n}function o(e={}){let t=parseInt(e.page??e.current)||1,r=parseInt(e.limit)||20,i=e.search||``,o=e.category1||``,s=e.category2||``,c=e.sort||`price_asc`,l=a(n,{search:i,category1:o,category2:s,sort:c}),u=(t-1)*r,d=u+r,f=l.slice(u,d);return{products:f,pagination:{page:t,limit:r,total:l.length,totalPages:Math.ceil(l.length/r),hasNext:d<l.length,hasPrev:t>1},filters:{search:i,category1:o,category2:s,sort:c}}}t.get(`/api/products/:id`,({params:t})=>{let{id:r}=t,i=n.find(e=>e.productId===r);if(!i)return e.json({error:`Product not found`},{status:404});let a={...i,description:`${i.title}에 대한 상세 설명입니다. ${i.brand} 브랜드의 우수한 품질을 자랑하는 상품으로, 고객 만족도가 높은 제품입니다.`,rating:Math.floor(Math.random()*2)+4,reviewCount:Math.floor(Math.random()*1e3)+50,stock:Math.floor(Math.random()*100)+10,images:[i.image,i.image.replace(`.jpg`,`_2.jpg`),i.image.replace(`.jpg`,`_3.jpg`)]};return e.json(a)}),t.get(`/api/categories`,async()=>{let t=i();return await r(),e.json(t)});export{o as getProductsOnServer,i as getUniqueCategories};